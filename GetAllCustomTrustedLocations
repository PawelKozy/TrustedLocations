$officeApps = @("Word", "Excel", "PowerPoint", "Outlook")

foreach ($app in $officeApps) {
    $key = "HKCU:\Software\Microsoft\Office\16.0\$app\Security\Trusted Locations"
    if(Test-Path $key){
        $locationKeys = Get-ChildItem -Path $key | Where-Object { $_.PSChildName -match "Location*" }
        Write-Host "Trusted Locations for ${app}:"
        if ($locationKeys) {
            foreach($locationKey in $locationKeys)
            {
                $default = (Get-ItemProperty -Path $locationKey.PSPath).Default
                if($default -eq 0){
                    $path = (Get-ItemProperty -Path $locationKey.PSPath).Path
                    Write-Host $path
                }
            }
        } else {
            Write-Host "No Custom Trusted Locations found for $app"
        }
    } else {
        Write-Host "No Custom Trusted Locations key found for $app"
    }
}
